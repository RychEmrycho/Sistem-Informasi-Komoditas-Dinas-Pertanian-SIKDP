<!DOCTYPE html>
<html lang="id" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<div th:replace="'template/head' :: head"></div>

<body>

<header th:replace="'template/navbar' :: navbar"></header>

<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="sidebar-sticky">
                <h5 class="d-flex align-items-center px-3 mt-2 mb-1 text-muted">Dashboard</h5>
                <ul class="nav flex-column" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#overview" id="overview-tab" role="tab">
                            <span class="far fa-dot-circle"></span> Overview <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#user" id="user-tab" role="tab">
                            <span class="far fa-user-circle"></span> User
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#kelompok" id="kelompok-tab" role="tab">
                            <span class="fa fa-users"></span> Kelompok tani
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#bantuan" id="bantuan-tab" role="tab">
                            <span class="fa fa-hands-helping"></span> Bantuan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#laporan" id="laporan-tab" role="tab">
                            <span class="fa fa-file"></span> Laporan kelompok
                        </a>
                    </li>

                    <!--hasil pertanian-->
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#hasilPertanian" id="hasil-pertanian-tab"
                           role="tab">
                            <span class="fa fa-cubes"></span> Hasil pertanian
                        </a>
                    </li>
                </ul>

                <hr>

                <div>
                    <h5 class="d-flex align-items-center px-3 mt-2 mb-1 text-muted">Admin</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/berita}">
                                <span class="fa fa-newspaper"></span> Berita
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/pengumuman}">
                                <span class="fa fa-bullhorn"></span> Pengumuman
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/komoditi}">
                                <span class="fa fa-box"></span> Komoditi
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/harga-komoditi}">
                                <span class="fa fa-dollar-sign"></span> Harga komoditi
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/kecamatan}">
                                <span class="fa fa-city"></span> Kecamatan
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/kelurahan}">
                                <span class="fa fa-city"></span> Kelurahan
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <main class="tab-content col-md-9 ml-sm-auto col-lg-10 px-4" role="main">
            <div class="tab-pane active" id="overview" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Overview</h1>
                </div>

                <div class="row">
                    <!--card overview-->
                    <div class="mb-4 col-md-12">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <canvas class="my-4 w-100 h-100" id="hasil-pertanian"></canvas>
                            </div>
                        </div>
                    </div>

                    <!--card komoditi-->
                    <div class="mb-4 col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-header">
                                Grafik komoditi pertanian
                            </div>
                            <div class="card-body">
                                <canvas class="my-4 w-100 h-100" id="komoditi"></canvas>
                            </div>
                        </div>
                    </div>

                    <!--card user-->
                    <div class="mb-4 col-md-3">
                        <div class="card text-center mb-2 shadow-sm">
                            <div class="card-header">
                                User
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">Verified:</h5>
                                <p class="card-text"><span th:text="${uActive}"></span> orang</p>
                                <hr>
                                <h5 class="card-title">Waiting:</h5>
                                <p class="card-text"><span th:text="${uWaiting}"></span> orang</p>
                                <hr>
                                <h5 class="card-title">Rejected:</h5>
                                <p class="card-text"><span th:text="${uRejected}"></span> orang</p>
                            </div>
                        </div>
                    </div>

                    <!--card kelompok-->
                    <div class="mb-4 col-md-3">
                        <div class="card text-center mb-2 shadow-sm">
                            <div class="card-header">
                                Kelompok tani
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">Verified:</h5>
                                <p class="card-text"><span th:text="${kActive}"></span> kelompok</p>
                                <hr>
                                <h5 class="card-title">Waiting:</h5>
                                <p class="card-text"><span th:text="${kWaiting}"></span> kelompok</p>
                                <hr>
                                <h5 class="card-title">Rejected:</h5>
                                <p class="card-text"><span th:text="${kRejected}"></span> kelompok</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane" id="user" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Users</h1>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th>Nama</th>
                            <th>Email</th>
                            <th>Kontak</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr th:each="user : ${users}">
                            <td th:text="${user.getNamaDepan()} + ' ' + ${user.getNamaBelakang()}">Emrycho C J
                                Simanungkalit
                            </td>
                            <td th:text="${user.getEmail()}">emricho1412@gmail.com</td>
                            <td th:text="${user.getNoHP()}">082272228000</td>
                            <td th:switch="${user.getActive()}">
                                <span class="badge badge-info" th:case="0" th:text="WAITING"></span>
                                <span class="badge badge-primary" th:case="1" th:text="ACTIVE"></span>
                                <span class="badge badge-danger" th:case="2" th:text="REJECTED"></span>
                            </td>
                            <td>
                                <div>
                                    <a class="btn btn-sm btn-secondary mr-2"
                                       th:href="@{/auth/view/} + ${user.id}">View</a>
                                    <div class="d-inline-flex" th:if="${user.active != 1 && user.active != 2}">
                                        <form class="mr-2" method="POST" th:action="@{/auth/accept}">
                                            <input name="id" th:value="${user.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-primary" type="submit">Accept</button>
                                        </form>
                                        <form class="mr-2" method="POST" th:action="@{/auth/reject}">
                                            <input name="id" th:value="${user.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-danger" type="submit">Reject</button>
                                        </form>
                                    </div>
                                </div>
                                <!--
                                                                <a class="btn btn-sm btn-primary" th:href="@{/auth/accept/} + ${user.id}">Accept</a>
                                                                <a class="btn btn-sm btn-danger" th:href="@{/auth/reject/} + ${user.id}">Reject</a>
                                -->
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane" id="kelompok" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Kelompok</h1>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th>Nama kelompok</th>
                            <th>Ketua</th>
                            <th>Kontak</th>
                            <th>Status</th>
                            <th>Proposal</th>
                            <th>Action</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr th:each="_kelompok : ${kelompok}">
                            <td th:text="${_kelompok.namaKelompok}">Maju Bersama</td>
                            <td th:text="${_kelompok.user.getNamaDepan()} + ' ' + ${_kelompok.user.getNamaBelakang()}">
                                Emrycho C J Simanungkalit
                            </td>
                            <td th:text="${_kelompok.noTelepon}">082272228000</td>
                            <td th:switch="${_kelompok.status}">
                                <span class="badge badge-info" th:case="0" th:text="WAITING"></span>
                                <span class="badge badge-primary" th:case="1" th:text="ACTIVE"></span>
                                <span class="badge badge-danger" th:case="2" th:text="REJECTED"></span>
                            </td>
                            <td><a th:href="@{/files/} + ${_kelompok.proposal}">Unduh file</a></td>
                            <td>
                                <div>
                                    <a class="btn btn-sm btn-secondary mr-2"
                                       th:href="@{/kelompok-tani/view/} + ${_kelompok.id}">View</a>
                                    <div class="d-inline-flex"
                                         th:if="${_kelompok.status != 1 && _kelompok.status != 2}">
                                        <form class="mr-2" method="POST" th:action="@{/kelompok-tani/accept}">
                                            <input name="id" th:value="${_kelompok.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-primary" type="submit">Accept</button>
                                        </form>
                                        <form class="mr-2" method="POST" th:action="@{/kelompok-tani/reject}">
                                            <input name="id" th:value="${_kelompok.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-danger" type="submit">Reject</button>
                                        </form>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane" id="laporan" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Laporan</h1>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th>Tanggal</th>
                            <th>Kelompok</th>
                            <th>Nama laporan</th>
                            <th>Status</th>
                            <th>Lampiran</th>
                            <th>Action</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr th:each="laporan : ${laporanKelompok}">
                            <td th:text="${#dates.format(laporan.tanggal, 'dd MMMM yyyy')}">22 Desember 2018</td>
                            <td th:text="${laporan.kelompokTani.namaKelompok}">Maju bersama</td>
                            <td th:text="${laporan.namaLaporan}">Laporan bulan desember 2018</td>
                            <td th:switch="${laporan.status}">
                                <span class="badge badge-info" th:case="0" th:text="WAITING"></span>
                                <span class="badge badge-primary" th:case="1" th:text="ACCEPTED"></span>
                                <span class="badge badge-danger" th:case="2" th:text="REJECTED"></span>
                            </td>
                            <td><a href="#">Unduh file</a></td>
                            <td>
                                <div>
                                    <a class="btn btn-sm btn-secondary mr-2"
                                       th:href="@{/laporan-kelompok/view/} + ${laporan.id}">View</a>
                                    <div class="d-inline-flex" th:if="${laporan.status != 1 && laporan.status != 2}">
                                        <form class="mr-2" method="POST" th:action="@{/laporan-kelompok/accept}">
                                            <input name="id" th:value="${laporan.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-primary" type="submit">Accept</button>
                                        </form>
                                        <form class="mr-2" method="POST" th:action="@{/laporan-kelompok/reject}">
                                            <input name="id" th:value="${laporan.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-danger" type="submit">Reject</button>
                                        </form>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane" id="bantuan" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Bantuan</h1>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th>Tanggal request</th>
                            <th>Nama kelompok</th>
                            <th>Judul bantuan</th>
                            <th>Status</th>
                            <th>Proposal</th>
                            <th>Action</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr th:each="_bantuan : ${bantuan}">
                            <td th:text="${#dates.format(_bantuan.tanggal, 'dd MMMM yyyy')}">20 Desember 2018</td>
                            <td th:text="${_bantuan.kelompokTani.namaKelompok}">Maju bersama</td>
                            <td th:text="${_bantuan.namaBantuan}">Pasokan pupuk untuk desa Sitoluama</td>
                            <td th:switch="${_bantuan.status}">
                                <span class="badge badge-info" th:case="0" th:text="WAITING"></span>
                                <span class="badge badge-primary" th:case="1" th:text="ACCEPTED"></span>
                                <span class="badge badge-danger" th:case="2" th:text="REJECTED"></span>
                            </td>
                            <td><a th:href="@{/files/} + ${_bantuan.proposal}">Unduh file</a></td>
                            <td>
                                <div>
                                    <a class="btn btn-sm btn-secondary mr-2"
                                       th:href="@{/bantuan/view/} + ${_bantuan.id}">View</a>
                                    <div class="d-inline-flex" th:if="${_bantuan.status != 1 && _bantuan.status != 2}">
                                        <form class="mr-2" method="POST" th:action="@{/bantuan/accept}">
                                            <input name="id" th:value="${_bantuan.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-primary" type="submit">Accept</button>
                                        </form>
                                        <form class="mr-2" method="POST" th:action="@{/bantuan/reject}">
                                            <input name="id" th:value="${_bantuan.id}" type="hidden"/>
                                            <button class="btn btn-sm btn-danger" type="submit">Reject</button>
                                        </form>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane" id="hasilPertanian" role="tabpanel">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Hasil pertanian</h1>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th>Tanggal request</th>
                            <th>Nama kelompok</th>
                            <th>Judul bantuan</th>
                            <th>Proposal</th>
                            <th>Action</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr>
                            <td>20 Desember 2018</td>
                            <td>Maju bersama</td>
                            <td>Pasokan pupuk untuk desa Sitoluama</td>
                            <td><a href="#">Unduh file</a></td>
                            <td>
                                <a class="btn btn-sm btn-secondary" href="#">View</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!--
                        <div id="adminSection">
                            <div class="tab-pane" id="laporan1" role="tabpanel">
                                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                                    <h1 class="h2">Laporan</h1>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover table-bordered table-striped">
                                        <thead class="thead-dark">
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Kelompok</th>
                                            <th>Nama laporan</th>
                                            <th>Lampiran</th>
                                            <th>Action</th>
                                        </tr>
                                        </thead>

                                        <tbody>
                                        <tr>
                                            <td>22 Desember 2018</td>
                                            <td>Maju bersama</td>
                                            <td>Laporan bulan desember 2018</td>
                                            <td><a href="#">Unduh file</a></td>
                                            <td>
                                                <a class="btn btn-sm btn-secondary" href="#">View</a>
                                                <a class="btn btn-sm btn-primary" href="#">Accept</a>
                                                <a class="btn btn-sm btn-danger" href="#">Reject</a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
            -->

        </main>
    </div>
</div>

<footer class="p-5 border-top col-md-9 ml-sm-auto col-lg-10 px-4"
        th:insert="~{'template/footer' :: footer-content}"></footer>

<!-- Bootstrap core JavaScript
================================================== -->
<script crossorigin="anonymous"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>

<!-- Graphs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
<script th:inline="javascript">
    var cHasilPertanian = document.getElementById("hasil-pertanian");
    var cKomoditi = document.getElementById("komoditi");

    var chartHP = new Chart(cHasilPertanian, {
        type: 'line',
        data: {
            labels: ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"],
            datasets: [{
                label: 'Hasil panen (Kg/bulan)',
                // data: [500, 650, 800, 700, 450, 950, 300, 400, 600, 1000, 1200, 800],
                data: /*[[${dataHasilPertanian}]]*/ [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                lineTension: 0,
                backgroundColor: 'transparent',
                borderColor: '#007bff',
                borderWidth: 4,
                pointBackgroundColor: '#007bff'
            }]
        },
        options: {
            title: {
                display: true,
                text: 'Grafik hasil panen seluruh Kelompok Tani'
            },
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: false
                    }
                }]
            },
            legend: {
                display: true,
            }
        }
    });

    var chartK = new Chart(cKomoditi, {
        type: 'pie',
        data: {
            // labels: ["Kopi", "Tomat", "Cabai", "Jagung", "Cengkeh", "Padi", "Durian", "Alpukat", "Jeruk", "Nenas"],
            labels: /*[[${listKomoditi}]]*/ ["Komoditi"],
            datasets: [{
                label: '5 Komoditi pertanian',
                data: /*[[${listJumlahKelompok}]]*/ [1],
                lineTension: 0,
                backgroundColor: [
                    '#F44336',
                    '#E91E63',
                    '#9C27B0',
                    '#673AB7',
                    '#3F51B5',
                    '#2196F3',
                    '#03A9F4',
                    '#00BCD4',
                    '#009688',
                    '#4CAF50'
                ]
            }]
        },
        options: {
            title: {
                display: true,
                text: 'Grafik komoditi pertanian terhadap jumlah kelompok'
            },
            responsive: true,
            legend: {
                display: true,
            }
        }
    });
</script>

<script>
    /*FOR BOOTSTRAP TAB PANE*/
    $(document).ready(() => {
        let url = location.href.replace(/\/$/, "");

        if (location.hash) {
            const hash = url.split("#");
            $('#myTab a[href="#' + hash[1] + '"]').tab("show");
            url = location.href.replace(/\/#/, "#");
            history.replaceState(null, null, url);
            setTimeout(() => {
                $(window).scrollTop(0);
            }, 400);
        }

        $('a[data-toggle="tab"]').on("click", function () {
            let newUrl;
            const hash = $(this).attr("href");
            if (hash === "#home") {
                newUrl = url.split("#")[0];
            } else {
                newUrl = url.split("#")[0] + hash;
            }
            newUrl += "/";
            history.replaceState(null, null, newUrl);
        });
    });
</script>

</body>
</html>